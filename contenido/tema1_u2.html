<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<style>
    /* --- VARIABLES & BASE --- */
    :root {
        --bg-deep: #020617;
        --grid-line: rgba(56, 189, 248, 0.15);
        --neon-blue: #0ea5e9;
        --neon-purple: #d8b4fe;
        --alert-red: #f43f5e;
        --text-ui: #94a3b8;
        --holo-green: #34d399;
        --glass-bg: rgba(15, 23, 42, 0.85);
    }

    * { box-sizing: border-box; }

    body {
        margin: 0;
        background-color: var(--bg-deep);
        color: white;
        font-family: 'Consolas', 'Courier New', monospace;
        height: 100vh;
        width: 100vw;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    /* --- FONDO ANIMADO --- */
    .grid-background {
        position: absolute;
        width: 200vw; height: 200vh;
        background-image: 
            linear-gradient(var(--grid-line) 1px, transparent 1px),
            linear-gradient(90deg, var(--grid-line) 1px, transparent 1px);
        background-size: 50px 50px;
        transform: perspective(500px) rotateX(60deg) translateY(-100px) translateZ(-200px);
        animation: gridMove 30s linear infinite;
        z-index: 0; opacity: 0.5;
    }
    @keyframes gridMove {
        0% { transform: perspective(500px) rotateX(60deg) translateY(0) translateZ(-200px); }
        100% { transform: perspective(500px) rotateX(60deg) translateY(50px) translateZ(-200px); }
    }

    /* --- LAYOUT PRINCIPAL RESPONSIVE --- */
    .main-interface {
        position: relative; z-index: 10;
        width: 100%; height: 100%;
        max-width: 1400px; /* Tope para pantallas ultra-wide */
        background: var(--glass-bg);
        display: grid;
        /* Default: Desktop layout */
        grid-template-columns: 260px 1fr 300px; 
        grid-template-rows: 60px 1fr 150px; 
        box-shadow: 0 0 40px rgba(0,0,0,0.5);
    }

    /* Header */
    .hud-header {
        grid-column: 1 / -1;
        grid-row: 1 / 2;
        display: flex; align-items: center; justify-content: space-between;
        padding: 0 20px;
        border-bottom: 1px solid rgba(255,255,255,0.1);
        background: rgba(2, 6, 23, 0.9);
    }

    /* Panel Izquierdo (Menú) */
    .panel-left {
        grid-column: 1 / 2;
        grid-row: 2 / 3;
        padding: 20px;
        border-right: 1px solid rgba(255,255,255,0.1);
        display: flex; flex-direction: column; gap: 10px;
        background: rgba(2, 6, 23, 0.4);
        overflow-y: auto;
    }

    /* Panel Central (Visual) */
    .panel-center {
        grid-column: 2 / 3;
        grid-row: 2 / 3;
        position: relative;
        overflow: hidden;
        display: flex; justify-content: center; align-items: center;
        background: radial-gradient(circle, transparent 20%, #000 100%);
    }

    /* Panel Derecho (Datos) */
    .panel-right {
        grid-column: 3 / 4;
        grid-row: 2 / 3;
        border-left: 1px solid rgba(255,255,255,0.1);
        padding: 20px;
        overflow-y: auto;
        background: rgba(0,0,0,0.2);
        display: flex; flex-direction: column; gap: 15px;
    }

    /* Panel Inferior (Consola) */
    .panel-bottom {
        grid-column: 1 / -1;
        grid-row: 3 / 4;
        border-top: 1px solid var(--neon-blue);
        background: rgba(2, 6, 23, 0.95);
        padding: 15px 20px;
        display: flex; flex-direction: column;
        position: relative;
    }

    /* --- COMPONENTES VISUALES --- */

    /* Silueta Ajustable */
    .human-silhouette {
        width: 100%; 
        max-width: 300px; /* Límite en desktop */
        height: 80%;
        background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/1/12/User_icon_2.svg/800px-User_icon_2.svg.png');
        background-size: contain; background-repeat: no-repeat; background-position: center;
        filter: invert(1) brightness(0.4) opacity(0.2);
        position: relative;
        transition: filter 0.5s ease;
    }

    .hotspot {
        position: absolute;
        width: 6%; padding-bottom: 6%; /* Mantiene aspecto 1:1 responsive */
        background: var(--neon-purple);
        border-radius: 50%;
        cursor: pointer;
        animation: ping 1.5s infinite;
        border: 2px solid white;
        z-index: 20;
        display: none;
        transform: translate(-50%, -50%); /* Centrar exactamente en el punto */
    }

    .layer-btn {
        background: rgba(255,255,255,0.05);
        border: 1px solid var(--text-ui);
        color: var(--text-ui);
        padding: 12px;
        cursor: pointer;
        font-family: inherit; font-size: 0.8rem;
        transition: all 0.2s;
        text-align: left;
    }
    .layer-btn.active {
        background: var(--neon-blue); color: #000; font-weight: bold; border-color: var(--neon-blue);
    }

    .data-card {
        background: rgba(30, 41, 59, 0.9);
        border-left: 3px solid var(--neon-purple);
        padding: 15px;
        font-size: 0.85rem;
        color: #e2e8f0;
        animation: slideIn 0.3s ease-out;
        box-shadow: 0 4px 6px rgba(0,0,0,0.3);
    }
    .data-card strong { display: block; margin-bottom: 5px; color: var(--neon-purple); }

    .console-text {
        color: #f1f5f9; font-size: 0.9rem; line-height: 1.5;
        flex-grow: 1; overflow-y: auto;
    }
    
    .action-btn {
        position: absolute; bottom: 20px; right: 20px;
        background: var(--neon-blue); border: none;
        padding: 8px 20px; color: black; font-weight: bold;
        cursor: pointer; clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
    }

    /* --- RESPONSIVE MEDIA QUERIES --- */

    /* 1. Laptop Pequeña / Tablet Horizontal (< 1200px) */
    @media (max-width: 1200px) {
        .main-interface {
            grid-template-columns: 220px 1fr; /* 2 Columnas */
            grid-template-rows: 50px 1fr 120px;
        }
        .panel-right {
            /* Se convierte en Overlay Flotante */
            position: absolute;
            right: 0; top: 50px; bottom: 120px;
            width: 280px;
            background: rgba(15, 23, 42, 0.95);
            border-left: 1px solid var(--neon-blue);
            transform: translateX(100%); /* Oculto por defecto */
            transition: transform 0.3s ease;
            z-index: 50;
        }
        .panel-right.active { transform: translateX(0); }
    }

    /* 2. Móvil / Tablet Vertical (< 768px) */
    @media (max-width: 768px) {
        .main-interface {
            display: flex; flex-direction: column; /* Stack vertical completo */
        }

        .hud-header { height: 50px; padding: 0 10px; font-size: 0.8rem; flex-shrink: 0; }

        .panel-center {
            flex-grow: 1; /* Ocupa el mayor espacio disponible */
            min-height: 40vh;
        }
        
        .human-silhouette { max-width: 200px; height: 70%; }

        /* El menú lateral pasa a ser una barra inferior o intermedia scrolleable */
        .panel-left {
            order: 3; /* Poner encima de la consola o debajo */
            height: auto; max-height: 150px;
            flex-direction: row; /* Botones horizontales */
            overflow-x: auto;
            border-right: none; border-top: 1px solid rgba(255,255,255,0.1);
            padding: 10px; flex-shrink: 0;
            white-space: nowrap;
        }
        
        .layer-btn { 
            min-width: 200px; /* Para que tengan buen tamaño táctil */
            margin-right: 10px;
        }

        .panel-bottom {
            order: 4;
            height: 200px; flex-shrink: 0;
            padding: 10px;
        }
        
        .action-btn { 
            position: static; width: 100%; margin-top: 10px; 
            text-align: center;
        }

        /* Ajuste del Panel Derecho (Datos) en móvil */
        .panel-right {
            top: 50px; bottom: 0; width: 100%; /* Pantalla completa menos header */
            height: auto;
            background: rgba(2, 6, 23, 0.98);
        }
        
        /* Botón para cerrar panel de datos en móvil */
        .close-panel-btn {
            display: block !important;
            margin-bottom: 10px;
            text-align: right; color: var(--alert-red);
        }
    }

    /* Botón cerrar (Solo visible en responsive) */
    .close-panel-btn { display: none; cursor: pointer; font-weight: bold; }

    /* Modal Final */
    .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.95); z-index: 100; justify-content: center; align-items: center; padding: 20px; }
    .modal-box { width: 100%; max-width: 600px; border: 1px solid var(--holo-green); background: #0f172a; padding: 20px; max-height: 80vh; overflow-y: auto; }

    /* Ajuste de scrollbars para móvil */
    ::-webkit-scrollbar { width: 4px; height: 4px; }
    ::-webkit-scrollbar-thumb { background: var(--neon-blue); border-radius: 2px; }

</style>
</head>
<body>

<div class="grid-background"></div>

<div class="main-interface">
    
    <!-- HEADER -->
    <div class="hud-header">
        <div><span style="color:var(--neon-blue)">UNP</span> // ANALISIS</div>
        <div style="font-size: 0.7rem; color: var(--text-ui);">U02-T1</div>
    </div>

    <!-- PANEL IZQUIERDO: MENÚ (Ahora horizontal en móvil) -->
    <div class="panel-left">
        <button class="layer-btn" onclick="loadContent('1.1', this)">1.1 HISTORIA</button>
        <button class="layer-btn" onclick="loadContent('1.2', this)">1.2 SISTEMA SEXO-GÉNERO</button>
        <button class="layer-btn" onclick="activateScanner(this)">1.3 ANÁLISIS RIESGO</button>
        
        <!-- Barra de progreso pequeña -->
        <div style="min-width: 100px; padding: 10px; display: flex; flex-direction: column; justify-content: center;">
             <div style="font-size: 0.6rem; margin-bottom: 2px;">PROGRESO</div>
             <div style="height: 4px; background: #333; width: 100%;">
                <div id="progress" style="width: 10%; height: 100%; background: var(--alert-red); transition: width 0.5s;"></div>
            </div>
        </div>
    </div>

    <!-- PANEL CENTRAL: VISUAL -->
    <div class="panel-center">
        <div class="human-silhouette" id="silhouette">
            <!-- HOTSPOTS (Posicionados en % para ser responsive) -->
            <div class="hotspot" style="top: 20%; left: 50%;" id="spot-indigena" onclick="showCaseData('indigena')"></div>
            <div class="hotspot" style="top: 35%; left: 30%;" id="spot-afro" onclick="showCaseData('afro')"></div>
            <div class="hotspot" style="top: 60%; left: 65%;" id="spot-campesina" onclick="showCaseData('campesina')"></div>
            <div class="hotspot" style="top: 25%; left: 40%;" id="spot-trans" onclick="showCaseData('trans')"></div>
            <div class="hotspot" style="top: 15%; left: 65%;" id="spot-lider" onclick="showCaseData('lider')"></div>
        </div>
        
        <!-- Aviso de escáner en móvil -->
        <div style="position: absolute; bottom: 10px; font-size: 0.7rem; color: var(--alert-red); opacity: 0.7;">
            SISTEMA ACTIVO
        </div>
    </div>

    <!-- PANEL DERECHO: DATOS (Flotante en responsive) -->
    <div class="panel-right" id="data-panel">
        <div class="close-panel-btn" onclick="closeDataPanel()">[ CERRAR X ]</div>
        <div id="data-content-area">
            <div style="text-align: center; color: var(--text-ui); font-size: 0.8rem; margin-top: 20px;">
                SELECCIONE PROTOCOLO
            </div>
        </div>
    </div>

    <!-- PANEL INFERIOR: CONSOLA -->
    <div class="panel-bottom">
        <div class="console-text">
            <span style="color:var(--neon-blue)">>> </span><span id="output-text"></span>
        </div>
        <button class="action-btn" onclick="showFinalReport()">VER APLICACIÓN UNP</button>
    </div>

</div>

<!-- MODAL FINAL -->
<div class="modal" id="final-modal">
    <div class="modal-box">
        <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
            <h3 style="margin:0; color:var(--holo-green)">2. APLICACIÓN UNP</h3>
            <button onclick="document.getElementById('final-modal').style.display='none'" style="background:none; border:none; color:white; font-size:1.2rem;">X</button>
        </div>
        <div style="line-height: 1.6; font-size: 0.9rem;">
            <p><strong>La interseccionalidad en la UNP implica:</strong></p>
            <ul style="padding-left: 20px;">
                <li>Identificar riesgos específicos según género, etnia y territorio.</li>
                <li>Reconocer diferencias (Ej: Mujer indígena vs Periodista urbana).</li>
                <li>Analizar factores combinados (Trans + Desplazada).</li>
                <li>Evaluar riesgo de forma precisa y no homogénea.</li>
            </ul>
            <p style="border-top: 1px solid #333; padding-top: 10px; color: var(--text-ui);">
                <em>Desafío detectado: Superar modelos estandarizados que ignoran capas de vulnerabilidad.</em>
            </p>
        </div>
    </div>
</div>

<script>
    // --- BASE DE DATOS (TEXTO ÍNTEGRO) ---
    const contentDB = {
        intro: "Iniciando sistema... Seleccione un módulo (1.1, 1.2) o active el escáner de riesgo (1.3).",
        "1.1": `<strong>1.1 Historia y significado:</strong><br>Enfoque interseccional como herramienta analítica. Examina cómo se cruzan discriminaciones (Género, Etnia, Clase, etc) generando riesgos específicos.`,
        "1.2": `<strong>1.2 Crítica sistema sexo-género:</strong><br>Análisis de roles impuestos, discriminación estructural y violencias basadas en género. La UNP debe adaptar sus enfoques a realidades complejas.`,
        "1.3": `<strong>1.3 ANÁLISIS DE RIESGO:</strong><br>Escáner activo. Toque los puntos en la silueta para identificar vulnerabilidades específicas (Indígenas, Afro, Lideresas, etc).`
    };

    const casesDB = {
        indigena: { title: "MUJERES INDÍGENAS", text: "Violencias territoriales, desplazamiento y afectación cultural." },
        afro: { title: "MUJERES AFRODESCENDIENTES", text: "Violencia sexual, racismo estructural y pobreza histórica." },
        campesina: { title: "MUJERES CAMPESINAS", text: "Acceso limitado a la tierra, estigmatización y exclusión." },
        trans: { title: "POBLACIÓN TRANS", text: "Violencia correctiva, amenazas armadas y exclusión social." },
        lider: { title: "LIDERESAS SOCIALES", text: "Amenazas directas por rol comunitario y defensa del territorio." }
    };

    let currentTypingTimeout = null;

    // Typewriter corregido (sin bugs de mezcla)
    function typeWriter(text) {
        const display = document.getElementById('output-text');
        if (currentTypingTimeout) clearTimeout(currentTypingTimeout);
        display.innerHTML = "";
        let i = 0;
        function typing() {
            if (text.charAt(i) === '<') {
                const tagEnd = text.indexOf('>', i);
                display.innerHTML += text.substring(i, tagEnd + 1);
                i = tagEnd + 1;
            } else {
                display.innerHTML += text.charAt(i);
                i++;
            }
            if (i < text.length) currentTypingTimeout = setTimeout(typing, 15);
            else currentTypingTimeout = null;
        }
        typing();
    }

    window.onload = function() { typeWriter(contentDB.intro); };

    function loadContent(key, btn) {
        resetUI();
        btn.classList.add('active');
        typeWriter(contentDB[key]);
        updateProgress(30);
        
        // En móvil/tablet, abrimos el panel derecho para confirmar carga
        openDataPanel(`<div class="data-card"><strong>MÓDULO CARGADO</strong>Revise la consola inferior para ver la teoría.</div>`);
    }

    function activateScanner(btn) {
        resetUI();
        btn.classList.add('active');
        document.querySelectorAll('.hotspot').forEach(h => h.style.display = 'block');
        document.getElementById('silhouette').style.filter = "invert(1) brightness(0.8) opacity(0.8) drop-shadow(0 0 15px red)";
        typeWriter(contentDB["1.3"]);
        updateProgress(60);
        
        // Mensaje en panel
        openDataPanel(`<div class="data-card" style="border-color:var(--alert-red)"><strong>ESCÁNER ACTIVO</strong><br>Interactúe con la silueta.</div>`);
    }

    function showCaseData(caseId) {
        const data = casesDB[caseId];
        const html = `<div class="data-card" style="border-color:var(--neon-purple)"><strong>${data.title}</strong>${data.text}</div>`;
        
        openDataPanel(html);
        typeWriter(`Riesgo detectado: ${data.title}`);
        updateProgress(90);
    }

    // Lógica Responsive para el panel derecho
    function openDataPanel(htmlContent) {
        const panel = document.getElementById('data-panel');
        const contentArea = document.getElementById('data-content-area');
        
        // Insertar contenido nuevo arriba
        const tempDiv = document.createElement('div');
        tempDiv.innerHTML = htmlContent;
        contentArea.insertBefore(tempDiv.firstChild, contentArea.firstChild);
        
        // Si estamos en móvil/tablet, forzar la clase active para mostrar el overlay
        if (window.innerWidth <= 1200) {
            panel.classList.add('active');
        }
    }

    function closeDataPanel() {
        document.getElementById('data-panel').classList.remove('active');
    }

    function resetUI() {
        document.querySelectorAll('.layer-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.hotspot').forEach(h => h.style.display = 'none');
        document.getElementById('silhouette').style.filter = "invert(1) brightness(0.4) opacity(0.2)";
        // No limpiamos el panel de datos histórico, solo cerramos en móvil
        if (window.innerWidth <= 1200) closeDataPanel();
    }

    function showFinalReport() {
        document.getElementById('final-modal').style.display = 'flex';
        updateProgress(100);
    }

    function updateProgress(val) {
        const bar = document.getElementById('progress');
        bar.style.width = val + "%";
        if(val > 80) bar.style.background = "var(--holo-green)";
    }
</script>

</body>
</html>