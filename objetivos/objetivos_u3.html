<!-- LIBRER√çAS: GSAP + Fuentes Modernas -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&family=Space+Grotesk:wght@400;700&display=swap" rel="stylesheet">

<style>
/* --- 1. EST√âTICA "AURORA FLUIDA" (CLARA - 25N) --- */
:root {
    /* Fondos */
    --fluid-bg: #F4F6F9;                 /* Fondo fluido claro */
    --card-bg: #FFFFFF;                  /* Fondo de tarjetas */

    /* Glass y Bordes */
    --glass: rgba(255, 255, 255, 0.8);    /* Glass blanco */
    --border: rgba(254, 200, 47, 0.5);    /* Borde amarillo suave */

    /* Acentos Institucionales */
    --accent-pink: #D23B78;              /* Emoci√≥n / tensi√≥n */
    --accent-cyan: #480241;              /* Morado UNP (Principal) */
    --accent-purple: #FF9800;            /* Naranja (Secundario) */
    --accent-yellow: #FEC82F;            /* Amarillo (Detalles) */

    /* Textos */
    --text-main: #333333;                /* Texto oscuro */
    --text-muted: #555555;               /* Texto secundario */
}

#prism-container {
    width: 100%;
    min-height: 750px;
    height: auto;
    background-color: var(--fluid-bg);
    position: relative;
    overflow: hidden;
    font-family: 'Outfit', sans-serif;
    color: var(--text-main);
    border-radius: 20px;
    display: flex;
    flex-direction: column;
    box-shadow: 0 10px 40px rgba(0,0,0,0.05);
    border: 1px solid #e0e0e0;
}

/* Fondo Aurora Animado (Suavizado para fondo claro) */
.aurora-blob {
    position: absolute;
    filter: blur(80px);
    opacity: 0.25; /* Menos opacidad para no saturar */
    border-radius: 50%;
    animation: floatAurora 12s infinite alternate cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 0;
}
.blob-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: var(--accent-cyan); } /* Morado */
.blob-2 { bottom: -10%; right: -10%; width: 40vw; height: 40vw; background: var(--accent-purple); animation-delay: -5s; } /* Naranja */
.blob-3 { top: 40%; left: 40%; width: 30vw; height: 30vw; background: var(--accent-pink); animation-duration: 15s; } /* Rosa */

@keyframes floatAurora {
    0% { transform: translate(0, 0) scale(1); }
    100% { transform: translate(40px, -40px) scale(1.1); }
}

/* Grid de Ruido (Sutil) */
.noise-overlay {
    position: absolute; top:0; left:0; width:100%; height:100%;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.03'/%3E%3C/svg%3E");
    z-index: 1; pointer-events: none;
}

/* --- 2. INTERFAZ --- */
.prism-header {
    position: relative; z-index: 10;
    padding: 20px 30px;
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid #eee;
    display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;
}

/* Logos Container */
.logos-container {
    display: flex; align-items: center; gap: 15px; margin-right: auto;
}
.client-logo {
    height: 45px; width: auto; object-fit: contain;
}

.title-group {
    display: flex; flex-direction: column;
}

.prism-title {
    font-family: 'Space Grotesk', sans-serif;
    font-size: clamp(1.2rem, 3vw, 1.6rem);
    color: var(--accent-cyan); /* Morado */
    font-weight: 700;
    margin: 0;
}

.prism-nav { display: flex; gap: 10px; margin-left: auto; }
.nav-pill {
    padding: 8px 18px; border-radius: 20px;
    background: #fff; border: 1px solid #ddd;
    font-size: 0.9rem; cursor: pointer; transition: 0.3s;
    color: var(--text-muted); font-weight: 500;
}
.nav-pill:hover { background: #f9f9f9; transform: translateY(-2px); }
.nav-pill.active { 
    background: var(--accent-cyan); color: white; border-color: var(--accent-cyan); 
    box-shadow: 0 4px 10px rgba(72, 2, 65, 0.2);
}

/* --- CONTENIDO --- */
.prism-content {
    flex: 1; position: relative; z-index: 5;
    padding: 40px; display: flex; flex-direction: column; align-items: center;
    overflow-y: auto;
}

/* SECCI√ìN 1: CONCEPTOS (Tarjetas) */
.concept-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 25px; width: 100%; max-width: 1100px;
    display: none; 
}
.holo-card {
    background: #FFFFFF; border: 1px solid #eee;
    border-left: 4px solid var(--accent-purple); /* Borde Naranja */
    border-radius: 12px; padding: 25px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.03);
    transition: 0.3s; position: relative; overflow: hidden;
}
.holo-card:hover { 
    transform: translateY(-5px); 
    border-color: var(--accent-cyan); /* Cambia a Morado */
    box-shadow: 0 10px 30px rgba(72, 2, 65, 0.1); 
}
.holo-card h3 { 
    color: var(--accent-cyan); margin-top:0; margin-bottom: 10px;
    font-family: 'Space Grotesk', sans-serif; font-size: 1.1rem;
}
.holo-card p {
    font-size: 0.95rem; line-height: 1.6; color: var(--text-muted);
}

/* SECCI√ìN 2: SIMULADOR (CHAT) */
.sim-container {
    width: 100%; max-width: 700px;
    background: #FFFFFF; border: 1px solid #ddd;
    border-radius: 16px; overflow: hidden;
    display: flex; flex-direction: column;
    height: 550px; 
    display: none; 
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
}

.chat-window {
    flex: 1; padding: 25px; overflow-y: auto;
    display: flex; flex-direction: column; gap: 20px;
    background: #F9FAFB;
}
.chat-bubble {
    padding: 15px 20px; border-radius: 12px; max-width: 85%;
    font-size: 0.95rem; line-height: 1.5; 
    animation: popIn 0.3s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}
.bot {
    background: #FFFFFF; border-top-left-radius: 2px; align-self: flex-start;
    border-left: 4px solid var(--accent-cyan); color: var(--text-main);
}
.user-choice {
    background: #FFF3E0; /* Naranja muy claro */
    border-bottom-right-radius: 2px; align-self: flex-end;
    border-right: 4px solid var(--accent-purple); text-align: right;
    color: #444;
}

.controls-area {
    padding: 20px; background: #FFFFFF;
    border-top: 1px solid #eee;
    display: flex; flex-direction: column; gap: 10px;
}
.option-btn {
    padding: 15px; border-radius: 8px; border: 1px solid #ddd;
    background: #fff; color: var(--text-main); cursor: pointer;
    transition: 0.2s; text-align: left; font-size: 0.95rem; font-weight: 500;
}
.option-btn:hover { 
    background: #F3E5F5; /* Morado claro */
    border-color: var(--accent-cyan); color: var(--accent-cyan); 
}

/* SECCI√ìN 3: OBJETIVOS (INFO) */
.info-section {
    width: 100%; max-width: 800px; display: none;
    background: #FFFFFF; padding: 40px; border-radius: 16px; 
    border: 1px solid #eee; border-top: 5px solid var(--accent-yellow);
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
}
.info-section h3 { margin-top: 0; font-family: 'Space Grotesk', sans-serif; }
.info-section li { margin-bottom: 10px; color: var(--text-muted); }

/* ANIMACIONES */
@keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

/* RESPONSIVE */
@media (max-width: 900px) {
    .prism-header { flex-direction: column; align-items: flex-start; }
    .logos-container { width: 100%; justify-content: space-between; margin-bottom: 10px; }
    .prism-nav { width: 100%; justify-content: center; margin-left: 0; }
}
@media (max-width: 600px) {
    .client-logo { height: 35px; }
    .prism-content { padding: 20px; }
}

</style>

<div id="prism-container">
    <div class="noise-overlay"></div>
    <!-- Blobs suaves -->
    <div class="aurora-blob blob-1"></div>
    <div class="aurora-blob blob-2"></div>
    <div class="aurora-blob blob-3"></div>

    <div class="prism-header">
        <div class="logos-container">
            <img src="../Styles/UNP I.svg" alt="Logo UNP" class="client-logo">
            <img src="../Styles/logo.png" alt="Logo Comisi√≥n" class="client-logo">
        </div>
        <div class="title-group">
            <h2 class="prism-title">Unidad 3: Identidades Diversas</h2>
        </div>
        <div class="prism-nav">
            <div class="nav-pill" onclick="showSection('info', this)">üéØ Objetivos</div>
            <div class="nav-pill active" onclick="showSection('concepts', this)">üß† Conceptos</div>
            <div class="nav-pill" onclick="showSection('sim', this)">üí¨ Simulador</div>
        </div>
    </div>

    <div class="prism-content">
        
        <!-- SECCI√ìN 1: OBJETIVOS & JUSTIFICACI√ìN -->
        <div id="sec-info" class="info-section">
            <h3 style="color:var(--accent-cyan)">OBJETIVOS DE APRENDIZAJE</h3>
            <ul style="line-height:1.6; padding-left:20px;">
                <li>Analizar cr√≠ticamente el sistema sexo-g√©nero y tensiones transfeministas.</li>
                <li>Reconocer el marco jur√≠dico para identidades no binarias y trans.</li>
                <li>Identificar violencias espec√≠ficas y proponer estrategias.</li>
                <li>Aplicar enfoque diferencial y comunicaci√≥n inclusiva.</li>
            </ul>
            <div style="margin-top:25px; padding:20px; background:#FFF8E1; border-left:4px solid var(--accent-purple); border-radius: 0 8px 8px 0; color: #444;">
                <strong>JUSTIFICACI√ìN:</strong> Esta unidad es clave para comprender la diversidad y los retos institucionales, fortaleciendo la capacidad para garantizar la no discriminaci√≥n.
            </div>
        </div>

        <!-- SECCI√ìN 2: CONCEPTOS CLAVE (TARJETAS) -->
        <div id="sec-concepts" class="concept-grid" style="display:grid;">
            <div class="holo-card">
                <h3>Sistema Sexo-G√©nero</h3>
                <p>Construcci√≥n social que asigna roles binarios. Las perspectivas transfeministas cuestionan esta rigidez, proponiendo un espectro fluido.</p>
            </div>
            <div class="holo-card">
                <h3>Marco Jur√≠dico</h3>
                <p>Jurisprudencia que protege el libre desarrollo de la personalidad. Incluye el reconocimiento de identidades Trans y No Binarias en documentos oficiales.</p>
            </div>
            <div class="holo-card">
                <h3>Enfoque Diferencial</h3>
                <p>Reconoce que las violencias afectan de forma distinta seg√∫n la orientaci√≥n sexual e identidad de g√©nero. Exige respuestas institucionales adaptadas.</p>
            </div>
            <div class="holo-card">
                <h3>Lenguaje Inclusivo</h3>
                <p>Pr√°cticas comunicativas que evitan el sexismo y la asunci√≥n de la cisnormatividad en la atenci√≥n al ciudadano.</p>
            </div>
        </div>

        <!-- SECCI√ìN 3: SIMULADOR (CHAT) -->
        <div id="sec-sim" class="sim-container">
            <div class="chat-window" id="chat-feed">
                <div class="chat-bubble bot">
                    üëã <strong>Sistema de Pr√°ctica:</strong><br>
                    Bienvenido/a. Est√°s en la ventanilla de atenci√≥n. Llega una persona con expresi√≥n de g√©nero femenina, pero su documento de identidad tiene nombre masculino ("Juan").<br><br>
                    ¬øC√≥mo procedes?
                </div>
            </div>
            
            <div class="controls-area" id="sim-controls">
                <button class="option-btn" onclick="playTurn(1)">A. "Se√±or Juan, siga por aqu√≠." (Usar dato del documento)</button>
                <button class="option-btn" onclick="playTurn(2)">B. "Buenos d√≠as, ¬øc√≥mo le gustar√≠a ser llamada/o?" (Preguntar pronombre)</button>
            </div>
        </div>

    </div>
</div>

<script>
// --- L√ìGICA DE NAVEGACI√ìN ---
function showSection(id, btn) {
    // Ocultar todo
    document.getElementById('sec-info').style.display = 'none';
    document.getElementById('sec-concepts').style.display = 'none';
    document.getElementById('sec-sim').style.display = 'none';
    
    // Quitar active
    document.querySelectorAll('.nav-pill').forEach(p => p.classList.remove('active'));

    // Mostrar selecci√≥n (con animaci√≥n GSAP)
    const target = document.getElementById('sec-' + id);
    if(id === 'concepts') target.style.display = 'grid';
    else if(id === 'sim') target.style.display = 'flex';
    else target.style.display = 'block';

    btn.classList.add('active');
    
    gsap.fromTo(target, {opacity: 0, y: 15}, {opacity: 1, y: 0, duration: 0.4});
}

// --- L√ìGICA DEL SIMULADOR (JUEGO DE ROLES) ---
let simStep = 0;

const simData = [
    { /* PASO 0 (INICIO) */ },
    {
        // PASO 1
        options: [
            {
                text: "A. Usar el nombre del documento sin preguntar.",
                correct: false,
                feedback: "‚ö†Ô∏è <strong>Error de Enfoque Diferencial:</strong> Llamar a una persona trans por su 'nombre muerto' (deadname) es revictimizante y viola el reconocimiento de su identidad.",
                nextStep: 2
            },
            {
                text: "B. Preguntar nombre identitario o pronombre.",
                correct: true,
                feedback: "‚ú® <strong>¬°Correcto!</strong> Siempre se debe preguntar c√≥mo prefiere ser tratada la persona, independientemente del documento. Esto garantiza el reconocimiento.",
                nextStep: 2
            }
        ]
    },
    {
        // PASO 2
        question: "La persona menciona que ha recibido amenazas por su identidad de g√©nero en su barrio. ¬øQu√© acci√≥n tomas?",
        options: [
            {
                text: "A. Registrarlo como 'problemas entre vecinos' (Generalizar).",
                correct: false,
                feedback: "‚ö†Ô∏è <strong>Incorrecto.</strong> Esto invisibiliza la violencia por prejuicio. Se debe identificar la violencia espec√≠fica hacia identidades diversas.",
                nextStep: 3
            },
            {
                text: "B. Activar ruta de riesgo por discriminaci√≥n/prejuicio.",
                correct: true,
                feedback: "‚ú® <strong>¬°Muy bien!</strong> Identificar la violencia espec√≠fica (cr√≠menes por prejuicio) permite activar las medidas de protecci√≥n adecuadas.",
                nextStep: 3
            }
        ]
    },
    {
        // PASO 3: FINAL
        question: "üéâ <strong>Simulaci√≥n Finalizada.</strong><br>Has aplicado el reconocimiento institucional y el enfoque diferencial.",
        options: [] 
    }
];

function playTurn(optionIndex) {
    const chatFeed = document.getElementById('chat-feed');
    const controls = document.getElementById('sim-controls');
    
    // 1. Mostrar elecci√≥n del usuario
    const userBubble = document.createElement('div');
    userBubble.className = 'chat-bubble user-choice';
    
    let currentStepData = simStep === 0 ? simData[1] : simData[simStep+1];
    
    // Safety check para evitar errores si el paso no existe
    if (!currentStepData || !currentStepData.options) return;

    let selectedText = optionIndex === 1 ? currentStepData.options[0].text : currentStepData.options[1].text;
    
    userBubble.innerHTML = "T√∫: " + selectedText;
    chatFeed.appendChild(userBubble);

    // 2. Procesar l√≥gica (Feedback)
    let choiceData = optionIndex === 1 ? currentStepData.options[0] : currentStepData.options[1];
    
    setTimeout(() => {
        const botBubble = document.createElement('div');
        botBubble.className = 'chat-bubble bot';
        botBubble.innerHTML = choiceData.feedback;
        
        // Estilos de borde seg√∫n acierto/error
        if(choiceData.correct) botBubble.style.borderLeftColor = 'var(--accent-cyan)'; // Morado
        else botBubble.style.borderLeftColor = '#D32F2F'; // Rojo error
        
        chatFeed.appendChild(botBubble);
        chatFeed.scrollTop = chatFeed.scrollHeight;

        // 3. Siguiente Pregunta
        simStep++;
        if(simStep < simData.length - 1 && simStep < 2) { 
             setTimeout(() => {
                 const nextQ = document.createElement('div');
                 nextQ.className = 'chat-bubble bot';
                 nextQ.innerHTML = simData[simStep+1].question;
                 chatFeed.appendChild(nextQ);
                 chatFeed.scrollTop = chatFeed.scrollHeight;
                 
                 let nextOpts = simData[simStep+1].options;
                 controls.innerHTML = `
                    <button class="option-btn" onclick="playTurn(1)">${nextOpts[0].text}</button>
                    <button class="option-btn" onclick="playTurn(2)">${nextOpts[1].text}</button>
                 `;
             }, 1000);
        } else if (simStep >= 2) {
             // Fin
             setTimeout(() => {
                 const endMsg = document.createElement('div');
                 endMsg.className = 'chat-bubble bot';
                 endMsg.innerHTML = "Has completado la pr√°ctica de atenci√≥n inclusiva.";
                 chatFeed.appendChild(endMsg);
                 chatFeed.scrollTop = chatFeed.scrollHeight;
                 controls.innerHTML = `<button class="option-btn" style="text-align:center;" onclick="location.reload()">Reiniciar Simulaci√≥n</button>`;
             }, 1000);
        }

    }, 500);
}

// Iniciar con la secci√≥n por defecto (Conceptos)
showSection('concepts', document.querySelectorAll('.nav-pill')[1]);

</script>