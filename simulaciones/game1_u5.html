<!-- LIBRER√çAS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Sora:wght@400;600;800&family=Inter:wght@400;600&display=swap" rel="stylesheet">

<style>
/* --- ESTILO INSTITUCIONAL MODERNO (CLARO) --- */
:root {
    /* Paleta Imagen */
    --tf-purple: #4B1E7A;          /* Estructural / Texto T√≠tulos */
    --tf-orange: #E35205;          /* Acento / Cargas pesadas */
    --tf-yellow: #FDB913;          /* Bloques est√°ndar */
    --tf-teal: #00A499;            /* Equilibrio / Soluci√≥n */
    
    --bg-main: #FFFFFF;            /* Fondo limpio */
    --bg-panel: #F9F9F9;           /* Fondo paneles */
    --text-main: #333333;          /* Texto lectura */
    
    --border-color: #e0e0e0;
    --border-radius: 16px;
    --shadow-soft: 0 10px 30px rgba(75, 30, 122, 0.1);
}

#balance-game-v2 {
    width: 100%;
    min-height: 900px;
    height: auto;
    background: linear-gradient(180deg, #FFFFFF 0%, #F3E5F5 100%);
    font-family: 'Inter', sans-serif;
    color: var(--text-main);
    border: 1px solid var(--border-color);
    border-radius: 20px;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
    padding: 20px;
}

/* --- LOGOS DEL CLIENTE --- */
.header-logos {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    margin-bottom: 20px;
    padding: 0 10px;
    z-index: 10;
}

.header-logos img {
    height: 55px;
    width: auto;
    object-fit: contain;
    transition: transform 0.3s ease;
}

/* --- HEADER TEXTO --- */
.game-header {
    text-align: center; 
    margin-bottom: 20px; 
    position: relative; 
    z-index: 5;
    padding: 0 15px;
}
.gh-title {
    font-family: 'Sora', sans-serif; 
    font-size: clamp(1.5rem, 4vw, 2.2rem);
    font-weight: 800;
    margin: 0 0 10px 0; 
    color: var(--tf-purple); 
    line-height: 1.2;
}
.gh-desc { 
    font-size: 1rem; 
    color: #555; 
    background: white;
    display: inline-block;
    padding: 8px 20px;
    border-radius: 30px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
}

/* --- BALANZA (DISE√ëO LIMPIO) --- */
.scale-stage {
    flex: 1; position: relative; min-height: 400px;
    display: flex; justify-content: center; align-items: center;
}

/* Estructura */
.scale-base {
    width: 40px; height: 160px; 
    background: var(--tf-purple); /* Base morada */
    position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%);
    border-radius: 20px 20px 0 0;
    box-shadow: inset 5px 0 10px rgba(0,0,0,0.2);
}
.scale-base::after { /* Pie */
    content:''; position: absolute; bottom: -10px; left: -50px;
    width: 140px; height: 20px; 
    background: var(--tf-purple); 
    border-radius: 10px;
}

/* Brazo */
.scale-arm-container {
    position: absolute; top: 100px; 
    width: 500px; height: 20px; 
}

.scale-beam {
    width: 100%; height: 12px; 
    background: #555; /* Metal oscuro */
    border-radius: 10px;
}

/* Platos */
.plate-group {
    position: absolute; top: 5px; width: 120px;
}
.pg-left { left: 0; }
.pg-right { right: 0; }

.rope {
    width: 2px; height: 120px; 
    background: #ccc; /* Cuerda gris clara */
    position: absolute; top: 0;
}
.rope-1 { left: 10px; transform: rotate(10deg); transform-origin: top; }
.rope-2 { right: 10px; transform: rotate(-10deg); transform-origin: top; }

.plate-dish {
    width: 120px; height: 10px; 
    background: var(--tf-purple);
    position: absolute; top: 120px; left: 0;
    display: flex; flex-direction: column-reverse; 
    align-items: center; justify-content: flex-start;
    border-radius: 5px;
}

/* ETIQUETAS DE PLATOS */
.plate-label {
    position: absolute; top: 140px; width: 100%; text-align: center;
    font-weight: bold; font-size: 0.8rem; color: #777;
    font-family: 'Sora', sans-serif;
    letter-spacing: 1px;
}

/* --- BLOQUES --- */
.block {
    width: 90px; height: 40px; margin-bottom: 2px;
    border: 1px solid rgba(0,0,0,0.1);
    border-radius: 6px;
    display: flex; align-items: center; justify-content: center;
    font-size: 0.75rem; font-weight: bold; text-align: center; line-height: 1.1;
    cursor: pointer; transition: 0.3s;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    font-family: 'Inter', sans-serif;
}

.block-visible { background: var(--tf-yellow); color: var(--tf-purple); }

/* Bloque misterioso */
.block-mystery {
    background: #f0f0f0; color: #999; border: 2px dashed #ccc;
}
.block-mystery::after { content: "?"; font-size: 1.2rem; }

/* Bloque revelado (Cargas pesadas) */
.block-revealed {
    background: var(--tf-orange); color: white; border: none;
    animation: flash 0.5s;
}

/* Bloque UNP (Soluci√≥n) */
.block-unp {
    background: var(--tf-purple); color: white; width: 110px; height: 50px;
    z-index: 10; border: 1px solid white;
}

/* --- CONTROLES Y HUD --- */
.controls-area {
    margin-top: auto; z-index: 20;
    display: flex; flex-direction: column; align-items: center; gap: 20px;
}

.inventory-box {
    background: white; 
    border: 1px solid #eee;
    padding: 20px; border-radius: 15px; width: 100%; max-width: 800px;
    text-align: center;
    box-shadow: 0 5px 20px rgba(0,0,0,0.05);
}
.inv-title { font-weight: 800; margin-bottom: 15px; color: var(--tf-purple); font-size: 0.9rem; letter-spacing: 1px; }

.block-pool {
    display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;
}

/* BOTONES DE ACCI√ìN */
.action-btn {
    padding: 12px 30px; font-family: 'Sora', sans-serif; font-size: 1rem; font-weight: bold;
    border: 1px solid #ccc; border-radius: 50px;
    cursor: pointer; transition: 0.2s; background: white; color: #999;
    pointer-events: none; opacity: 0.6;
    display: flex; align-items: center; gap: 10px;
}

.action-btn.active {
    background: var(--tf-orange); color: white; border-color: var(--tf-orange);
    pointer-events: all; opacity: 1;
    box-shadow: 0 4px 15px rgba(227, 82, 5, 0.3);
}
.action-btn.active:hover { transform: translateY(-2px); }

.unp-btn.active {
    background: var(--tf-purple) !important; 
    border-color: var(--tf-purple) !important;
    box-shadow: 0 4px 15px rgba(75, 30, 122, 0.3);
}

/* --- MODALES --- */
.modal-overlay {
    position: absolute; top:0; left:0; width:100%; height:100%;
    background: rgba(255,255,255,0.95); z-index: 100;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    padding: 30px; text-align: center; box-sizing: border-box;
    backdrop-filter: blur(5px);
}
.modal-box {
    background: white; border: 1px solid #eee;
    padding: 40px; border-radius: 20px; 
    box-shadow: 0 20px 50px rgba(0,0,0,0.1);
    max-width: 600px;
}
.m-title { 
    font-family: 'Sora', sans-serif; 
    font-weight: 800;
    font-size: 1.8rem; 
    color: var(--tf-purple); 
    margin-bottom: 15px; 
}
.m-text { font-size: 1.1rem; line-height: 1.6; margin-bottom: 30px; color: #555; }
.m-btn {
    background: var(--tf-purple); color: white; border: none;
    padding: 12px 30px; font-weight: bold; cursor: pointer; font-size: 1rem;
    border-radius: 30px; transition: 0.3s;
}
.m-btn:hover { background: var(--tf-orange); transform: scale(1.05); }

/* ANIMACIONES */
@keyframes flash { 0% { transform: scale(1); } 50% { transform: scale(1.1); background: white; } 100% { transform: scale(1); } }

/* RESPONSIVE */
@media (max-width: 768px) {
    .header-logos img { height: 40px; }
    .scale-arm-container { width: 280px; } /* Reducir balanza */
    .plate-group { width: 90px; }
    .block { width: 70px; font-size: 0.6rem; }
    .gh-title { font-size: 1.5rem; }
}

</style>

<div id="balance-game-v2">

    <!-- HEADER CON LOGOS (AGREGADO) -->
    <div class="header-logos">
        <img src="../Styles/UNP I.svg" alt="Logo UNP">
        <img src="../Styles/logo.png" alt="Logo Comisi√≥n">
    </div>

    <div class="game-header">
        <h1 class="gh-title">Balanza de Cargas Laborales</h1>
        <div class="gh-desc">Objetivo: Analizar la desigualdad y aplicar la corresponsabilidad.</div>
    </div>

    <!-- ESCENARIO -->
    <div class="scale-stage">
        <div class="scale-base"></div>
        
        <!-- BRAZO -->
        <div class="scale-arm-container" id="scale-arm">
            <div class="scale-beam"></div>
            
            <!-- PLATO IZQUIERDO (Visible) -->
            <div class="plate-group pg-left">
                <div class="rope rope-1"></div>
                <div class="rope rope-2"></div>
                <div class="plate-dish" id="dish-left"></div>
                <div class="plate-label">TRABAJO PRODUCTIVO</div>
            </div>

            <!-- PLATO DERECHO (Invisible/Cuidado) -->
            <div class="plate-group pg-right">
                <div class="rope rope-1"></div>
                <div class="rope rope-2"></div>
                <div class="plate-dish" id="dish-right"></div>
                <div class="plate-label">TRABAJO DE CUIDADO</div>
            </div>
        </div>
    </div>

    <!-- CONTROLES -->
    <div class="controls-area">
        
        <!-- Panel de Botones Principales -->
        <div style="display:flex; gap:15px; flex-wrap:wrap; justify-content:center;">
            <button class="action-btn" id="btn-glasses" onclick="revealLoads()">
                üëì ACTIVAR GAFAS DE G√âNERO
            </button>
            <button class="action-btn unp-btn" id="btn-unp" onclick="applyUNP()">
                üèõÔ∏è APLICAR CORRESPONSABILIDAD UNP
            </button>
        </div>

        <!-- Inventario -->
        <div class="inventory-box" id="inv-box">
            <div class="inv-title">A√ëADE PESO A LA BALANZA (CLIC):</div>
            <div class="block-pool">
                <div class="block block-visible" onclick="addBlock('visible', 'Jornada Laboral')">Jornada Laboral</div>
                <div class="block block-mystery" onclick="addBlock('mystery', null)">Carga Oculta</div>
                <div class="block block-mystery" onclick="addBlock('mystery', null)">Carga Oculta</div>
                <div class="block block-visible" onclick="addBlock('visible', 'Informes')">Informes</div>
                <div class="block block-mystery" onclick="addBlock('mystery', null)">Carga Oculta</div>
            </div>
        </div>
    </div>

    <!-- MODAL INICIO (CONTEXTO) -->
    <div class="modal-overlay" id="intro-modal">
        <div class="modal-box">
            <div class="m-title">¬øQU√â SON LAS CARGAS INVISIBLES?</div>
            <p class="m-text">
                Son trabajos no remunerados (cuidado de hijos, hogar, gesti√≥n emocional) que recaen desproporcionadamente sobre las mujeres.
                <br><br>
                <strong>Misi√≥n:</strong> Coloca las cargas en la balanza y usa las "Gafas de G√©nero" para ver c√≥mo estas afectan la igualdad laboral en la UNP.
            </p>
            <button class="m-btn" onclick="closeIntro()">ENTENDIDO, EMPEZAR</button>
        </div>
    </div>

    <!-- MODAL FINAL -->
    <div class="modal-overlay" id="end-modal" style="display:none;">
        <div class="modal-box">
            <div class="m-title" style="color:var(--tf-teal)">EQUILIBRIO ALCANZADO</div>
            <p class="m-text">
                Al aplicar la <strong>Corresponsabilidad UNP</strong>, la instituci√≥n reconoce que el cuidado es un derecho y un deber colectivo, no solo de las mujeres.
                <br><br>
                Esto previene violencias econ√≥micas y psicol√≥gicas derivadas de la sobrecarga.
            </p>
            <button class="m-btn" style="background:var(--tf-teal);" onclick="location.reload()">REPETIR EJERCICIO</button>
        </div>
    </div>

</div>

<script>
// --- VARIABLES ---
let leftWeight = 0;
let rightWeight = 0;
let mysteryCount = 0;
let phase = 1; // 1: Cargar, 2: Revelar, 3: UNP

// Textos espec√≠ficos de Violencia/Cuidado
const hiddenTexts = [
    "Doble Jornada", 
    "Gesti√≥n Emocional", 
    "Cuidado Enfermos", 
    "Miedo al Acoso", 
    "Estigmatizaci√≥n"
];

// --- FUNCIONES ---

function closeIntro() {
    gsap.to("#intro-modal", {opacity: 0, duration: 0.5, onComplete: () => {
        document.getElementById('intro-modal').style.display = 'none';
    }});
}

function addBlock(type, label) {
    if (phase !== 1) return;

    const block = document.createElement('div');
    
    if (type === 'visible') {
        block.className = "block block-visible";
        block.innerText = label;
        document.getElementById('dish-left').appendChild(block);
        leftWeight += 10;
    } else {
        block.className = "block block-mystery";
        // No tiene texto aun, solo el ? del CSS
        document.getElementById('dish-right').appendChild(block);
        rightWeight += 15; // Pesan m√°s simb√≥licamente
        mysteryCount++;
    }

    // Animaci√≥n Ca√≠da
    gsap.from(block, {y: -50, opacity: 0, duration: 0.4, ease: "back.out"});

    updatePhysics();
    checkButtonStatus();
}

function updatePhysics() {
    // Calcular inclinaci√≥n
    const diff = rightWeight - leftWeight;
    // Limitar rotaci√≥n max 15deg
    let rotation = diff * 0.3;
    if(rotation > 15) rotation = 15;
    if(rotation < -15) rotation = -15;

    // Mover Brazo
    gsap.to("#scale-arm", {rotation: rotation, duration: 1, ease: "power2.out"});
    
    // Contra-rotar platos para que no se vuelquen
    gsap.to(".plate-group", {rotation: -rotation, duration: 1, ease: "power2.out"});
}

function checkButtonStatus() {
    // Activar bot√≥n de gafas si hay al menos 2 bloques misteriosos
    if (mysteryCount >= 2) {
        document.getElementById('btn-glasses').classList.add('active');
        document.getElementById('btn-glasses').innerText = "üëì ACTIVAR GAFAS DE G√âNERO (LISTO)";
        document.getElementById('btn-glasses').style.opacity = "1";
    }
}

function revealLoads() {
    if (phase !== 1) return;
    phase = 2;

    // Cambiar estado visual
    document.getElementById('btn-glasses').classList.remove('active');
    document.getElementById('btn-glasses').style.opacity = "0.5";
    document.getElementById('inv-box').style.opacity = "0.5";
    document.getElementById('inv-box').style.pointerEvents = "none";

    // Revelar bloques misteriosos
    const hiddenBlocks = document.querySelectorAll('.block-mystery');
    hiddenBlocks.forEach((block, index) => {
        setTimeout(() => {
            block.classList.remove('block-mystery');
            block.classList.add('block-revealed');
            // Asignar texto rotativo
            block.innerText = hiddenTexts[index % hiddenTexts.length];
        }, index * 300);
    });

    // Aumentar peso derecho dr√°sticamente (La realidad pesa)
    rightWeight += 40;
    updatePhysics();

    // Activar bot√≥n UNP
    setTimeout(() => {
        const btnUNP = document.getElementById('btn-unp');
        btnUNP.classList.add('active');
        gsap.from(btnUNP, {scale: 1.2, duration: 0.5, yoyo: true, repeat: 1});
    }, 1500);
}

function applyUNP() {
    if (phase !== 2) return;
    phase = 3;

    // Crear Bloque UNP Grande
    const unpBlock = document.createElement('div');
    unpBlock.className = "block block-unp";
    unpBlock.innerText = "SISTEMA DE CUIDADO UNP";
    
    // A√±adir al lado Izquierdo para ayudar a soportar la carga
    document.getElementById('dish-left').appendChild(unpBlock);
    
    // Forzar equilibrio perfecto (La instituci√≥n asume la carga)
    gsap.to("#scale-arm", {rotation: 0, duration: 1.5, ease: "elastic.out(1, 0.5)"});
    gsap.to(".plate-group", {rotation: 0, duration: 1.5, ease: "elastic.out(1, 0.5)"});

    // Mostrar Final
    setTimeout(() => {
        const endModal = document.getElementById('end-modal');
        endModal.style.display = 'flex';
        gsap.from(endModal.children[0], {y: 50, opacity: 0});
    }, 2000);
}

// Iniciar
gsap.from(".game-header", {y: -50, opacity: 0, duration: 1});

</script>