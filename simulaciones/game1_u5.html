<!-- LIBRER√çAS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Work+Sans:wght@400;700&display=swap" rel="stylesheet">

<style>
/* --- ESTILO MEMPHIS MODERNO (S√ìLIDO) --- */
:root {
    --bg-color: #FEC82F;          /* Fondo claro c√°lido */
    --text-color: #170047;        /* Texto principal */

    --accent-purple: #480241;     /* Acento estructural */
    --accent-teal: #EE7D4F;       /* Acento secundario / interacci√≥n */
    --accent-red: #E44700;        /* Error / √©nfasis negativo */
    --accent-yellow: #D23B78;     /* √ânfasis positivo / foco */

    --border-color: #170047;      /* Bordes */
    --border-width: 3px;
}


#balance-game-v2 {
    width: 100%;
    min-height: 850px;
    height: auto;
    background-color: var(--bg-color) !important;
    background-image: radial-gradient(var(--border-color) 1px, transparent 1px);
    background-size: 25px 25px;
    font-family: 'Work Sans', sans-serif;
    color: var(--text-color);
    border: var(--border-width) solid var(--border-color);
    border-radius: 12px;
    position: relative;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
    padding: 20px;
}

/* --- HEADER --- */
.game-header {
    text-align: center; margin-bottom: 30px; position: relative; z-index: 5;
    background: white; border: var(--border-width) solid var(--border-color);
    padding: 15px; box-shadow: 5px 5px 0 var(--border-color);
}
.gh-title {
    font-family: 'Fredoka', sans-serif; font-size: clamp(1.5rem, 4vw, 2.2rem);
    margin: 0; color: var(--accent-purple); text-transform: uppercase;
}
.gh-desc { font-size: 0.95rem; margin-top: 5px; color: #555; }

/* --- BALANZA (RESPONSIVE) --- */
.scale-stage {
    flex: 1; position: relative; min-height: 400px;
    display: flex; justify-content: center; align-items: center;
}

/* Estructura */
.scale-base {
    width: 40px; height: 160px; background: var(--border-color);
    position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%);
    border-radius: 20px 20px 0 0;
}
.scale-base::after { /* Pie */
    content:''; position: absolute; bottom: -10px; left: -50px;
    width: 140px; height: 20px; background: var(--border-color); border-radius: 10px;
}

/* Brazo */
.scale-arm-container {
    position: absolute; top: 100px; /* Ajuste visual */
    width: 500px; height: 20px; 
    /* El pivote es el centro */
}

.scale-beam {
    width: 100%; height: 15px; background: var(--border-color); border-radius: 10px;
}

/* Platos */
.plate-group {
    position: absolute; top: 5px; width: 120px;
    /* Importante: transform-origin arriba para el p√©ndulo */
}
.pg-left { left: 0; }
.pg-right { right: 0; }

.rope {
    width: 2px; height: 120px; background: #555; position: absolute; top: 0;
}
.rope-1 { left: 10px; transform: rotate(10deg); transform-origin: top; }
.rope-2 { right: 10px; transform: rotate(-10deg); transform-origin: top; }

.plate-dish {
    width: 120px; height: 10px; background: var(--border-color);
    position: absolute; top: 120px; left: 0;
    display: flex; flex-direction: column-reverse; /* Apilar hacia arriba */
    align-items: center; justify-content: flex-start;
}

/* ETIQUETAS DE PLATOS */
.plate-label {
    position: absolute; top: 140px; width: 100%; text-align: center;
    font-weight: bold; font-size: 0.8rem; background: white; 
    border: 1px solid black; padding: 2px;
}

/* --- BLOQUES --- */
.block {
    width: 90px; height: 40px; margin-bottom: 2px;
    border: 2px solid var(--border-color);
    display: flex; align-items: center; justify-content: center;
    font-size: 0.7rem; font-weight: bold; text-align: center; line-height: 1.1;
    cursor: pointer; transition: 0.3s;
    box-shadow: 2px 2px 0 rgba(0,0,0,0.1);
}

.block-visible { background: var(--accent-teal); color: white; }

/* El bloque "misterioso" ahora es visible como inc√≥gnita */
.block-mystery {
    background: #e0e0e0; color: #555; border-style: dashed;
}
.block-mystery::after { content: "?"; font-size: 1.2rem; }

/* El bloque revelado */
.block-revealed {
    background: var(--accent-red); color: white; border-style: solid;
    animation: flash 0.5s;
}

.block-unp {
    background: var(--accent-purple); color: white; width: 110px; height: 50px;
    z-index: 10;
}

/* --- CONTROLES Y HUD --- */
.controls-area {
    margin-top: auto; z-index: 20;
    display: flex; flex-direction: column; align-items: center; gap: 20px;
}

.inventory-box {
    background: white; border: var(--border-width) solid var(--border-color);
    padding: 15px; border-radius: 10px; width: 100%; max-width: 800px;
    text-align: center;
}
.inv-title { font-weight: bold; margin-bottom: 10px; text-transform: uppercase; color: var(--accent-purple); }

.block-pool {
    display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;
}

/* BOTONES DE ACCI√ìN */
.action-btn {
    padding: 15px 30px; font-family: 'Fredoka', sans-serif; font-size: 1.1rem;
    border: var(--border-width) solid var(--border-color); border-radius: 50px;
    cursor: pointer; transition: 0.2s; background: #ddd; color: #777;
    pointer-events: none; /* Desactivado por defecto */
    display: flex; align-items: center; gap: 10px;
}

.action-btn.active {
    background: var(--accent-yellow); color: black;
    pointer-events: all; box-shadow: 5px 5px 0 var(--border-color);
}
.action-btn.active:hover { transform: translate(-2px, -2px); box-shadow: 7px 7px 0 var(--border-color); }

.unp-btn {
    background: var(--accent-purple) !important; color: white !important;
}

/* --- MODALES --- */
.modal-overlay {
    position: absolute; top:0; left:0; width:100%; height:100%;
    background: rgba(255,255,255,0.95); z-index: 100;
    display: flex; flex-direction: column; justify-content: center; align-items: center;
    padding: 30px; text-align: center; box-sizing: border-box;
}
.modal-box {
    background: white; border: 3px solid var(--border-color);
    padding: 30px; border-radius: 15px; box-shadow: 10px 10px 0 var(--accent-teal);
    max-width: 600px;
}
.m-title { font-family: 'Fredoka'; font-size: 2rem; color: var(--accent-purple); margin-bottom: 15px; }
.m-text { font-size: 1.1rem; line-height: 1.6; margin-bottom: 20px; }
.m-btn {
    background: var(--accent-teal); color: white; border: 2px solid black;
    padding: 10px 25px; font-weight: bold; cursor: pointer; font-size: 1rem;
}

/* ANIMACIONES */
@keyframes flash { 0% { transform: scale(1); } 50% { transform: scale(1.1); background: white; } 100% { transform: scale(1); } }

/* RESPONSIVE */
@media (max-width: 700px) {
    .scale-arm-container { width: 280px; } /* Reducir balanza */
    .plate-group { width: 90px; }
    .block { width: 70px; font-size: 0.6rem; }
    .gh-title { font-size: 1.5rem; }
}

</style>

<div id="balance-game-v2">

    <div class="game-header">
        <h1 class="gh-title">Balanza de Cargas Laborales</h1>
        <div class="gh-desc">Objetivo: Analizar la desigualdad y aplicar la corresponsabilidad.</div>
    </div>

    <!-- ESCENARIO -->
    <div class="scale-stage">
        <div class="scale-base"></div>
        
        <!-- BRAZO -->
        <div class="scale-arm-container" id="scale-arm">
            <div class="scale-beam"></div>
            
            <!-- PLATO IZQUIERDO (Visible) -->
            <div class="plate-group pg-left">
                <div class="rope rope-1"></div>
                <div class="rope rope-2"></div>
                <div class="plate-dish" id="dish-left"></div>
                <div class="plate-label">TRABAJO PRODUCTIVO</div>
            </div>

            <!-- PLATO DERECHO (Invisible/Cuidado) -->
            <div class="plate-group pg-right">
                <div class="rope rope-1"></div>
                <div class="rope rope-2"></div>
                <div class="plate-dish" id="dish-right"></div>
                <div class="plate-label">TRABAJO DE CUIDADO</div>
            </div>
        </div>
    </div>

    <!-- CONTROLES -->
    <div class="controls-area">
        
        <!-- Panel de Botones Principales -->
        <div style="display:flex; gap:15px; flex-wrap:wrap; justify-content:center;">
            <button class="action-btn" id="btn-glasses" onclick="revealLoads()">
                üëì ACTIVAR GAFAS DE G√âNERO
            </button>
            <button class="action-btn unp-btn" id="btn-unp" onclick="applyUNP()">
                üèõÔ∏è APLICAR CORRESPONSABILIDAD UNP
            </button>
        </div>

        <!-- Inventario -->
        <div class="inventory-box" id="inv-box">
            <div class="inv-title">A√ëADE PESO A LA BALANZA (Click):</div>
            <div class="block-pool">
                <div class="block block-visible" onclick="addBlock('visible', 'Jornada Laboral')">Jornada Laboral</div>
                <div class="block block-mystery" onclick="addBlock('mystery', null)">Carga Oculta</div>
                <div class="block block-mystery" onclick="addBlock('mystery', null)">Carga Oculta</div>
                <div class="block block-visible" onclick="addBlock('visible', 'Informes')">Informes</div>
                <div class="block block-mystery" onclick="addBlock('mystery', null)">Carga Oculta</div>
            </div>
        </div>
    </div>

    <!-- MODAL INICIO (CONTEXTO) -->
    <div class="modal-overlay" id="intro-modal">
        <div class="modal-box">
            <div class="m-title">¬øQU√â SON LAS CARGAS INVISIBLES?</div>
            <p class="m-text">
                Son trabajos no remunerados (cuidado de hijos, hogar, gesti√≥n emocional) que recaen desproporcionadamente sobre las mujeres.
                <br><br>
                <strong>Misi√≥n:</strong> Coloca las cargas en la balanza y usa las "Gafas de G√©nero" para ver c√≥mo estas afectan la igualdad laboral en la UNP.
            </p>
            <button class="m-btn" onclick="closeIntro()">ENTENDIDO, EMPEZAR</button>
        </div>
    </div>

    <!-- MODAL FINAL -->
    <div class="modal-overlay" id="end-modal" style="display:none;">
        <div class="modal-box" style="border-color:var(--accent-purple);">
            <div class="m-title">EQUILIBRIO ALCANZADO</div>
            <p class="m-text">
                Al aplicar la <strong>Corresponsabilidad UNP</strong>, la instituci√≥n reconoce que el cuidado es un derecho y un deber colectivo, no solo de las mujeres.
                <br><br>
                Esto previene violencias econ√≥micas y psicol√≥gicas derivadas de la sobrecarga.
            </p>
            <button class="m-btn" style="background:var(--accent-purple);" onclick="location.reload()">REPETIR EJERCICIO</button>
        </div>
    </div>

</div>

<script>
// --- VARIABLES ---
let leftWeight = 0;
let rightWeight = 0;
let mysteryCount = 0;
let phase = 1; // 1: Cargar, 2: Revelar, 3: UNP

// Textos espec√≠ficos de Violencia/Cuidado
const hiddenTexts = [
    "Doble Jornada", 
    "Gesti√≥n Emocional", 
    "Cuidado Enfermos", 
    "Miedo al Acoso", 
    "Estigmatizaci√≥n"
];

// --- FUNCIONES ---

function closeIntro() {
    gsap.to("#intro-modal", {opacity: 0, duration: 0.5, onComplete: () => {
        document.getElementById('intro-modal').style.display = 'none';
    }});
}

function addBlock(type, label) {
    if (phase !== 1) return;

    const block = document.createElement('div');
    
    if (type === 'visible') {
        block.className = "block block-visible";
        block.innerText = label;
        document.getElementById('dish-left').appendChild(block);
        leftWeight += 10;
    } else {
        block.className = "block block-mystery";
        // No tiene texto aun, solo el ? del CSS
        document.getElementById('dish-right').appendChild(block);
        rightWeight += 15; // Pesan m√°s simb√≥licamente
        mysteryCount++;
    }

    // Animaci√≥n Ca√≠da
    gsap.from(block, {y: -50, opacity: 0, duration: 0.4, ease: "back.out"});

    updatePhysics();
    checkButtonStatus();
}

function updatePhysics() {
    // Calcular inclinaci√≥n
    const diff = rightWeight - leftWeight;
    // Limitar rotaci√≥n max 15deg
    let rotation = diff * 0.3;
    if(rotation > 15) rotation = 15;
    if(rotation < -15) rotation = -15;

    // Mover Brazo
    gsap.to("#scale-arm", {rotation: rotation, duration: 1, ease: "power2.out"});
    
    // Contra-rotar platos para que no se vuelquen
    gsap.to(".plate-group", {rotation: -rotation, duration: 1, ease: "power2.out"});
}

function checkButtonStatus() {
    // Activar bot√≥n de gafas si hay al menos 2 bloques misteriosos
    if (mysteryCount >= 2) {
        document.getElementById('btn-glasses').classList.add('active');
        document.getElementById('btn-glasses').innerText = "üëì ACTIVAR GAFAS DE G√âNERO (LISTO)";
    }
}

function revealLoads() {
    if (phase !== 1) return;
    phase = 2;

    // Cambiar estado visual
    document.getElementById('btn-glasses').classList.remove('active');
    document.getElementById('btn-glasses').style.opacity = "0.5";
    document.getElementById('inv-box').style.opacity = "0.5";
    document.getElementById('inv-box').style.pointerEvents = "none";

    // Revelar bloques misteriosos
    const hiddenBlocks = document.querySelectorAll('.block-mystery');
    hiddenBlocks.forEach((block, index) => {
        setTimeout(() => {
            block.classList.remove('block-mystery');
            block.classList.add('block-revealed');
            // Asignar texto rotativo
            block.innerText = hiddenTexts[index % hiddenTexts.length];
        }, index * 300);
    });

    // Aumentar peso derecho dr√°sticamente (La realidad pesa)
    rightWeight += 40;
    updatePhysics();

    // Activar bot√≥n UNP
    setTimeout(() => {
        const btnUNP = document.getElementById('btn-unp');
        btnUNP.classList.add('active');
        gsap.from(btnUNP, {scale: 1.2, duration: 0.5, yoyo: true, repeat: 1});
    }, 1500);
}

function applyUNP() {
    if (phase !== 2) return;
    phase = 3;

    // Crear Bloque UNP Grande
    const unpBlock = document.createElement('div');
    unpBlock.className = "block block-unp";
    unpBlock.innerText = "SISTEMA DE CUIDADO UNP";
    
    // A√±adir al lado Izquierdo para ayudar a soportar la carga
    document.getElementById('dish-left').appendChild(unpBlock);
    
    // Forzar equilibrio perfecto (La instituci√≥n asume la carga)
    gsap.to("#scale-arm", {rotation: 0, duration: 1.5, ease: "elastic.out(1, 0.5)"});
    gsap.to(".plate-group", {rotation: 0, duration: 1.5, ease: "elastic.out(1, 0.5)"});

    // Mostrar Final
    setTimeout(() => {
        const endModal = document.getElementById('end-modal');
        endModal.style.display = 'flex';
        gsap.from(endModal.children[0], {y: 50, opacity: 0});
    }, 2000);
}

// Iniciar
gsap.from(".game-header", {y: -50, opacity: 0, duration: 1});

</script>