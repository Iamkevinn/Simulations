<!-- LIBRERAS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Oswald:wght@500&display=swap" rel="stylesheet">

<style>
/* --- ESTILOS TEMA CLARO (LIGHT THEME) --- */

/* 1. CONTENEDOR PRINCIPAL: Fondo Blanco/Gris Claro */
#juris-final-container {
    background-color: #F8FAFC !important; /* Fondo muy claro (casi blanco) */
    width: 100%;
    min-height: 800px;
    height: auto;
    font-family: 'Roboto', sans-serif;
    color: #334155 !important; /* Texto Gris Oscuro */
    border: 1px solid #E2E8F0 !important; /* Borde sutil */
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    box-sizing: border-box;
    position: relative;
    z-index: 1;
    overflow: hidden; /* Para que las esquinas redondeadas funcionen bien */
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

/* 2. CABECERA CON LOGOS */
.final-header {
    background-color: #FFFFFF !important; /* Blanco puro */
    padding: 20px;
    border-bottom: 4px solid #0EA5E9 !important; /* Azul Cian corporativo */
    display: flex;
    align-items: center;
    justify-content: space-between; /* Logos a los extremos */
    flex-wrap: wrap;
    gap: 15px;
}

/* Estilos de los logos */
.client-logo {
    height: 60px; /* Tama帽o prominente */
    width: auto;
    object-fit: contain;
    display: block;
}

.final-title {
    color: #0F172A !important; /* Azul marino muy oscuro */
    font-family: 'Oswald', sans-serif;
    font-size: 1.6rem;
    text-transform: uppercase;
    margin: 0;
    text-align: center;
    flex: 1; /* Ocupa el espacio central */
}

/* 3. NAVEGACIN */
.final-nav {
    display: flex;
    justify-content: center;
    gap: 15px;
    padding: 20px;
    background-color: #F1F5F9 !important; /* Gris muy suave */
    flex-wrap: wrap;
    border-bottom: 1px solid #E2E8F0;
}

.final-btn {
    background-color: #FFFFFF !important; /* Bot贸n blanco */
    color: #64748B !important; /* Texto gris */
    border: 2px solid #CBD5E1 !important;
    padding: 12px 25px;
    cursor: pointer;
    font-weight: bold;
    font-family: 'Oswald', sans-serif;
    text-transform: uppercase;
    transition: all 0.2s;
    border-radius: 6px;
}

.final-btn:hover {
    background-color: #E2E8F0 !important;
    color: #334155 !important;
}

.final-btn.active {
    background-color: #0EA5E9 !important; /* Azul activo */
    color: #FFFFFF !important; /* Texto blanco */
    border-color: #0284C7 !important;
    box-shadow: 0 2px 4px rgba(14, 165, 233, 0.3);
}

/* 4. REA DE CONTENIDO */
.final-viewport {
    padding: 30px;
    flex: 1;
    display: flex;
    justify-content: center;
    background-color: #F8FAFC;
}

/* VISTA 1: TARJETAS DE TEORA */
.theory-grid-final {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    width: 100%;
    max-width: 1100px;
    display: none; /* Controlado por JS */
}

.theory-card-final {
    background-color: #FFFFFF !important; /* Tarjeta blanca */
    color: #334155 !important;
    border: 1px solid #E2E8F0 !important;
    border-top: 5px solid #0EA5E9 !important; /* Borde superior azul */
    padding: 25px;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05); /* Sombra suave */
}

.theory-card-final h3 {
    color: #0369A1 !important; /* Azul oscuro para t铆tulos */
}

/* VISTA 2: JUEGO */
.game-container-final {
    width: 100%;
    max-width: 1200px;
    display: none; /* Controlado por JS */
    flex-direction: column;
}

.scenario-box {
    background-color: #EFF6FF !important; /* Azul muy p谩lido */
    border-left: 5px solid #3B82F6 !important; /* Azul fuerte */
    padding: 20px;
    margin-bottom: 30px;
    border-radius: 6px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

.scenario-text {
    color: #1E293B !important;
    font-size: 1.1rem;
    font-style: italic;
    margin: 0;
}

/* COLUMNAS Y BOTONES DEL JUEGO */
.columns-final {
    display: flex;
    gap: 30px;
    width: 100%;
    flex-wrap: wrap; 
}

.col-final {
    flex: 1;
    min-width: 300px; 
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.col-label-final {
    background-color: #334155 !important; /* Encabezado columna gris oscuro */
    color: #FFFFFF !important;
    padding: 12px;
    text-align: center;
    font-weight: bold;
    font-family: 'Oswald', sans-serif;
    border-radius: 6px 6px 0 0;
}

/* BOTN DE OPCIN */
.opt-btn-final {
    background-color: #FFFFFF !important; /* Fondo blanco */
    color: #334155 !important; /* Texto oscuro */
    padding: 20px;
    border: 2px solid #CBD5E1 !important; /* Borde gris claro */
    border-radius: 8px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    transition: transform 0.1s, box-shadow 0.1s;
    position: relative;
    z-index: 10;
}

/* ID CIRCULAR */
.opt-id-final {
    background-color: #E2E8F0 !important;
    color: #475569 !important;
    width: 35px;
    height: 35px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    border-radius: 50%;
    margin-right: 15px;
    flex-shrink: 0;
}

/* ESTADOS DEL BOTN */
.opt-btn-final:hover {
    background-color: #F1F5F9 !important;
    border-color: #94A3B8 !important;
    transform: translateY(-2px);
}

.opt-btn-final.selected {
    background-color: #E0F2FE !important; /* Azul muy claro */
    border-color: #0EA5E9 !important; /* Borde Azul */
    box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.3) !important;
}

.opt-btn-final.matched {
    background-color: #DCFCE7 !important; /* Verde muy claro */
    border-color: #22C55E !important; /* Borde verde */
    color: #14532D !important; /* Texto verde oscuro */
    pointer-events: none;
}

.opt-btn-final.matched .opt-id-final {
    background-color: #22C55E !important;
    color: white !important;
}

/* FEEDBACK */
.feedback-final {
    margin-top: 30px;
    padding: 15px;
    background-color: #FFFFFF !important;
    border: 1px solid #E2E8F0;
    border-radius: 8px;
    text-align: center;
    color: #64748B !important;
    font-family: monospace;
    font-weight: bold;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}

/* RESPONSIVE: Ajuste de logos y columnas */
@media (max-width: 768px) {
    .columns-final { flex-direction: column; }
    .col-label-final { text-align: left; }
    
    .final-header {
        flex-direction: column;
        text-align: center;
    }
    .client-logo {
        height: 50px; /* Un poco m谩s peque帽os en m贸vil */
        margin-bottom: 10px;
    }
    .final-title {
        order: 2; /* T铆tulo en medio visualmente o al final seg煤n preferencia */
        margin: 10px 0;
    }
}
</style>

<div id="juris-final-container">

    <!-- CABECERA CON LOGOS -->
    <div class="final-header">
        <!-- Logo UNP -->
        <img src="../Styles/UNP I.svg" alt="Logo UNP" class="client-logo">
        
        <h2 class="final-title">Reconocimiento Jur铆dico (Unidad 3)</h2>
        
        <!-- Logo Comisi贸n -->
        <img src="../Styles/logo.png" alt="Logo Comisi贸n" class="client-logo">
    </div>

    <div class="final-nav">
        <button class="final-btn active" onclick="setViewFinal('theory')"> Ver Normativa</button>
        <button class="final-btn" onclick="setViewFinal('game')">锔 Jugar Caso</button>
    </div>

    <div class="final-viewport">
        
        <!-- TEORA -->
        <div id="view-theory-final" class="theory-grid-final" style="display: grid;">
            <div class="theory-card-final">
                <h3 style="margin-top:0;">Sentencia T-033 de 2022</h3>
                <p>Ordena incluir el marcador "No Binario" (NB) en documentos de identidad.</p>
            </div>
            <div class="theory-card-final">
                <h3 style="margin-top:0;">Sentencia T-527 de 2024</h3>
                <p>Exige an谩lisis de riesgo con enfoque diferencial estricto para personas trans.</p>
            </div>
            <div class="theory-card-final">
                <h3 style="margin-top:0;">No Discriminaci贸n</h3>
                <p>Obligaci贸n activa del Estado de eliminar barreras administrativas.</p>
            </div>
            <div class="theory-card-final">
                <h3 style="margin-top:0;">Ajustes Institucionales</h3>
                <p>Adaptar formularios y protocolos para respetar el nombre identitario.</p>
            </div>
        </div>

        <!-- JUEGO -->
        <div id="view-game-final" class="game-container-final">
            
            <div class="scenario-box">
                <p class="scenario-text">
                    "CASO #402: Alex (persona no binaria) solicita protecci贸n. El formulario solo tiene F/M. El funcionario exige usar el nombre antiguo porque 'el sistema no tiene otra opci贸n'."
                </p>
            </div>

            <p style="color:#64748B !important; margin-bottom:15px; opacity:1 !important; text-align:center;">
                INSTRUCCIN: Toca un <strong>HECHO</strong> (Izquierda) y su <strong>FUNDAMENTO</strong> (Derecha).
            </p>

            <div class="columns-final">
                <!-- IZQUIERDA -->
                <div class="col-final" id="col-left-final">
                    <div class="col-label-final">OBSERVACIN DE HECHOS</div>
                    
                    <div class="opt-btn-final" onclick="gameClick('left', 0, this)">
                        <div class="opt-id-final">1</div>
                        <span>Formulario Binario (solo F/M)</span>
                    </div>
                    <div class="opt-btn-final" onclick="gameClick('left', 1, this)">
                        <div class="opt-id-final">2</div>
                        <span>Exigencia nombre antiguo</span>
                    </div>
                    <div class="opt-btn-final" onclick="gameClick('left', 2, this)">
                        <div class="opt-id-final">3</div>
                        <span>"El sistema no tiene opci贸n"</span>
                    </div>
                </div>

                <!-- DERECHA -->
                <div class="col-final" id="col-right-final">
                    <div class="col-label-final">FUNDAMENTO JURDICO</div>
                    
                    <div class="opt-btn-final" onclick="gameClick('right', 2, this)">
                        <div class="opt-id-final">A</div>
                        <span>Obligaci贸n Activa (Eliminar Barreras)</span>
                    </div>
                    <div class="opt-btn-final" onclick="gameClick('right', 0, this)">
                        <div class="opt-id-final">B</div>
                        <span>Sentencia T-033/22 (Marcador NB)</span>
                    </div>
                    <div class="opt-btn-final" onclick="gameClick('right', 1, this)">
                        <div class="opt-id-final">C</div>
                        <span>Derecho Identidad (Nombre Social)</span>
                    </div>
                </div>
            </div>

            <div class="feedback-final" id="feedback-msg-final">
                ESPERANDO SELECCIN...
            </div>
        </div>
    </div>
</div>

<script>
// --- CONTROL DE VISTAS (SIN CAMBIOS) ---
function setViewFinal(view) {
    document.querySelectorAll('.final-btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');

    const theory = document.getElementById('view-theory-final');
    const game = document.getElementById('view-game-final');

    if(view === 'theory') {
        game.style.display = 'none';
        theory.style.display = 'grid';
    } else {
        theory.style.display = 'none';
        game.style.display = 'flex';
        // Animaci贸n de entrada
        gsap.from(".opt-btn-final", {x: 20, opacity: 0, stagger: 0.1, clearProps:"all"});
    }
}

// --- LGICA DEL JUEGO (SIN CAMBIOS) ---
let leftSelF = null;
let rightSelF = null;
let pairsF = 0;

function gameClick(side, id, el) {
    if(el.classList.contains('matched')) return;

    const fb = document.getElementById('feedback-msg-final');

    // Reset visual de selecci贸n en la columna actual
    const parentId = side === 'left' ? 'col-left-final' : 'col-right-final';
    document.getElementById(parentId).querySelectorAll('.opt-btn-final').forEach(b => b.classList.remove('selected'));
    
    el.classList.add('selected');

    if(side === 'left') leftSelF = {id, el};
    else rightSelF = {id, el};

    // Validar si hay par
    if(leftSelF && rightSelF) {
        if(leftSelF.id === rightSelF.id) {
            // Correcto
            fb.innerText = ">> 隆CONEXIN CORRECTA!";
            fb.style.color = "#16A34A"; // Verde

            leftSelF.el.classList.add('matched');
            rightSelF.el.classList.add('matched');
            leftSelF.el.classList.remove('selected');
            rightSelF.el.classList.remove('selected');

            leftSelF = null;
            rightSelF = null;
            pairsF++;

            if(pairsF === 3) {
                fb.innerText = ">> CASO COMPLETADO: AJUSTES REQUERIDOS.";
                fb.style.color = "#2563EB"; // Azul xito
            }
        } else {
            // Incorrecto
            fb.innerText = ">> ERROR: NO CORRESPONDE.";
            fb.style.color = "#DC2626"; // Rojo

            gsap.to([leftSelF.el, rightSelF.el], {x: 5, duration: 0.1, yoyo: true, repeat: 3});

            setTimeout(() => {
                leftSelF.el.classList.remove('selected');
                rightSelF.el.classList.remove('selected');
                leftSelF = null;
                rightSelF = null;
                fb.innerText = "INTENTA DE NUEVO...";
                fb.style.color = "#64748B"; // Gris neutro
            }, 1000);
        }
    }
}
</script>