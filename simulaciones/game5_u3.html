<!-- LIBRERÍAS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">

<style>
/* --- VARIABLES --- */
:root {
    --bg-dark: #1e1e24;
    --paper-text: #1a1a1a;
    --accent: #8338ec; 
    --handle: #00b4d8;
}

/* CONTENEDOR GENERAL */
#workshop-slider-v2 {
    width: 100%;
    background-color: var(--bg-dark) !important;
    font-family: 'Montserrat', sans-serif;
    color: white !important;
    border: 2px solid #444 !important;
    border-radius: 12px;
    padding: 20px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
}

/* HEADER */
.slider-header { text-align: center; margin-bottom: 20px; }
.slider-title { font-weight: 800; font-size: clamp(1.5rem, 4vw, 2.2rem); margin: 0; text-transform: uppercase; color: white !important; }
.slider-instr { font-family: 'Space Mono', monospace; font-size: 0.8rem; color: #ccc; background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 4px; margin-top: 10px; display: inline-block; }

/* --- COMPARADOR (SOLUCIÓN DE ALTURA) --- */
.comparison-wrapper {
    position: relative;
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
    border-radius: 8px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.5);
    background: #ffffff !important;
    /* Quitamos overflow hidden global para que no corte sombras, pero lo manejamos internamente */
    user-select: none;
}

/* ESTILOS COMUNES DE TEXTO (Para que alineen perfecto) */
.doc-content {
    padding: 40px; /* Espacio interno generoso */
    box-sizing: border-box;
    font-family: 'Space Mono', monospace;
    font-size: clamp(0.9rem, 2.5vw, 1.1rem); /* Fuente escalable */
    line-height: 2; /* Altura de línea amplia para leer bien */
    color: var(--paper-text) !important;
    margin: 0;
}

.doc-heading {
    font-weight: bold; font-size: 1.3rem; 
    border-bottom: 2px solid #ccc; padding-bottom: 10px; margin-bottom: 20px; 
    display: block;
}

/* CAPA BASE (MALA/ROJA) - ESTA DEFINE LA ALTURA */
.layer-base {
    position: relative; /* Clave: Relative empuja la altura del contenedor */
    width: 100%;
    height: auto; /* Crece con el texto */
    background-color: #ffeaea !important; 
    z-index: 1;
}

/* CAPA SUPERIOR (BUENA/VERDE) - ESTA SE RECORTA */
.layer-overlay {
    position: absolute; /* Flota encima */
    top: 0; left: 0; bottom: 0; /* Se estira al alto de la base */
    width: 50%; /* Ancho inicial */
    background-color: #e8fff0 !important;
    z-index: 2;
    overflow: hidden; /* Aquí sucede la magia del recorte */
    border-right: 3px solid var(--handle);
}

/* El contenido dentro del overlay debe tener un ancho fijo para no refluir al cortar */
.layer-overlay .doc-content {
    width: 100vw; /* Truco: Forzar ancho grande para que el texto no se mueva al reducir la ventana */
    max-width: 800px; /* Pero limitado al contenedor */
}
/* Corrección específica para asegurar alineación */
.comparison-wrapper { container-type: inline-size; }

/* RESALTADOS */
.bad { background-color: #ffb3b3 !important; color: #b30000 !important; text-decoration: line-through; padding: 0 5px; }
.good { background-color: #b3ffb3 !important; color: #006600 !important; padding: 0 5px; }

/* HANDLE (MANIJA) */
.slider-handle {
    position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
    width: 40px; height: 40px; background: var(--handle) !important;
    border-radius: 50%; z-index: 10; display: flex; align-items: center; justify-content: center;
    cursor: col-resize; box-shadow: 0 0 15px rgba(0, 180, 216, 0.6); border: 3px solid white;
    touch-action: none; /* Crucial para móvil */
}

/* ETIQUETAS */
.label-floating {
    position: absolute; bottom: 10px; font-size: 0.7rem; font-weight: bold; padding: 5px; border-radius: 3px; color: white;
}

/* RESPONSIVE AGRESIVO */
@media (max-width: 1200px) {
    .doc-content { padding: 20px; line-height: 1.6; } /* Menos padding en móvil */
    .doc-heading { font-size: 1.1rem; }
    /* Ajuste para que el texto overlay coincida con el base en pantallas pequeñas */
    .layer-overlay .doc-content { width: 100%; } 
}
</style>

<div id="workshop-slider-v2">
    
    <div class="slider-header">
        <h2 class="slider-title">Transformación del Lenguaje</h2>
        <div class="slider-instr">↔ ARRASTRA LA BARRA AZUL</div>
    </div>

    <div class="comparison-wrapper" id="comp-wrap">
        
        <!-- CAPA BASE (Define la altura) -->
        <div class="layer-base">
            <div class="doc-content">
                <span class="doc-heading">MEMORANDO #001</span>
                Para: <span class="bad">Los directores</span> de área.<br><br>
                Informar a <span class="bad">los usuarios</span> que deben actualizar datos. 
                Es deber de <span class="bad">los ciudadanos</span> y <span class="bad">sus esposas</span>.<br><br>
                <span class="bad">El jefe</span> revisará el ingreso de <span class="bad">los visitantes</span>.<br><br>
                Atentamente,<br>La Administración.
                <div class="label-floating" style="right:10px; background:#ef233c;">ORIGINAL</div>
            </div>
        </div>

        <!-- CAPA SUPERIOR (Se recorta) -->
        <div class="layer-overlay" id="overlay-layer">
            <!-- IMPORTANTE: El contenido debe ser idéntico en estructura al de arriba -->
            <div class="doc-content" id="overlay-content">
                <span class="doc-heading">MEMORANDO #001</span>
                Para: <span class="good">La dirección</span> de área.<br><br>
                Informar a <span class="good">la población</span> que deben actualizar datos. 
                Es deber de <span class="good">la ciudadanía</span> y <span class="good">sus cónyuges</span>.<br><br>
                <span class="good">La jefatura</span> revisará el ingreso de <span class="good">las visitas</span>.<br><br>
                Atentamente,<br>La Administración.
                <div class="label-floating" style="left:10px; background:#38b000;">INCLUSIVO</div>
            </div>
        </div>

        <!-- MANIJA -->
        <div class="slider-handle" id="handle-btn">↔</div>

    </div>

    <!-- PASOS -->
    <div style="display:grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap:20px; margin-top:30px;">
        <div style="background:#2b2b36; padding:15px; border-left:4px solid #8338ec;">
            <strong>1. IDENTIFICAR:</strong> Busca generalizaciones masculinas.
        </div>
        <div style="background:#2b2b36; padding:15px; border-left:4px solid #8338ec;">
            <strong>2. TRANSFORMAR:</strong> Usa sustantivos colectivos.
        </div>
    </div>

</div>

<script>
const wrapper = document.getElementById('comp-wrap');
const overlay = document.getElementById('overlay-layer');
const handleBtn = document.getElementById('handle-btn');
const overlayContent = document.getElementById('overlay-content');

let isDragging = false;

function updateSlider(x) {
    const rect = wrapper.getBoundingClientRect();
    let posX = x - rect.left;

    if (posX < 0) posX = 0;
    if (posX > rect.width) posX = rect.width;

    const percent = (posX / rect.width) * 100;

    overlay.style.width = percent + "%";
    handleBtn.style.left = percent + "%";
    
    // Truco: Para que el texto de la capa superior no se mueva al recortar,
    // debemos fijar su ancho al ancho total del contenedor padre.
    overlayContent.style.width = rect.width + "px";
}

// Eventos Mouse
wrapper.addEventListener('mousedown', () => isDragging = true);
document.addEventListener('mouseup', () => isDragging = false);
document.addEventListener('mousemove', (e) => {
    if (!isDragging) return;
    updateSlider(e.pageX);
});

// Eventos Touch (Móvil)
wrapper.addEventListener('touchstart', (e) => {
    isDragging = true;
    updateSlider(e.touches[0].pageX);
});
document.addEventListener('touchend', () => isDragging = false);
document.addEventListener('touchmove', (e) => {
    if (!isDragging) return;
    updateSlider(e.touches[0].pageX);
});

// Inicialización: Ajustar ancho de contenido overlay al cargar y al redimensionar
function syncWidth() {
    overlayContent.style.width = wrapper.offsetWidth + "px";
}
window.addEventListener('resize', syncWidth);
// Ejecutar al inicio con pequeña demora para asegurar renderizado
setTimeout(syncWidth, 100);

// Animación inicial
gsap.to(handleBtn, {left: "50%", duration: 1.5, ease: "power2.inOut", onUpdate: function() {
    overlay.style.width = handleBtn.style.left;
}});

</script>